#!/bin/bash

if [ -z "$1" ]
  then
    echo "Usage: $0 <source-code.c>"
    echo "        Example:"
    echo "           $0 ./code/hello_world.c"
    exit
fi
set -ex

C_FILENAME=$1
MOUNT_PATH=TODO_MOUNT_PATH
IMAGE_FOLDER=TODO_IMAGE_FOLDER
KERNEL=TODO_KERNEL
IMAGE_FOLDER_CHROOT=$IMAGE_FOLDER/chroot/
IMAGE=$IMAGE_FOLDER/bullseye.img

# compile C file
helpers/userland/compile_userland.sh $C_FILENAME $IMAGE_FOLDER_CHROOT

# Update image
helpers/userland/sync_image.sh $IMAGE_FOLDER_CHROOT $IMAGE $MOUNT_PATH

# run in qemu
helpers/userland/run.sh $KERNEL $IMAGE
